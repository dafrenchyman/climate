var MenuItems={};var MenuData=[];function LoadDatasets(){var b=document.getElementsByTagName("head")[0];try{b.removeChild(d.getElementById("LoadDatasets"))}catch(c){}var a=document.createElement("script");a.type="text/javascript";a.id="LoadDatasets";a.src="./php/g_datasets.php";a.onload=function(){var j=0;MenuItems.id=0;for(var e=0;e<Datasets.Name.length;e++){var h=Datasets.Name[e].split("|");var g=h;var f=MenuItems;var m=0;for(var l=0;l<g.length;l++){var k=g[l];if(!f.hasOwnProperty(k)){f[k]={};f[k].id=++j;f[k].parentId=m;if(l===g.length-1){MenuData.push({id:j,parentId:m,name:k,FullName:Datasets.Name[e],Dataset_ID:Datasets.Dataset_ID[e],DatabaseStore:Datasets.DatabaseStore[e],OriginalLocation:Datasets.OriginalLocation[e],StartDate:Datasets.StartDate[e],EndDate:Datasets.EndDate[e],Units:Datasets.Units[e],DefaultLevel:Datasets.DefaultLevel[e]})}else{MenuData.push({id:j,parentId:m,name:k})}}m=f[k].id;f=f[k]}}};b.appendChild(a)}LoadDatasets();function LoadLevelDataMenu(e,a){var b="php/g_GetLevel.php?dbname="+e.DatabaseStore;var c=$.getScript(b);$.when(c).done(function(){$("#Levels").empty();for(i=0;i<Levels.Name.length;i++){var h="";if(i==0){h='checked="checked"'}var j=Levels.Level_ID[i];var g=Levels.Name[i];var f=$('<input type="radio" id="levelRadio'+parseInt(j)+'" onchange="changeLevel(this.value, function(){LoadSphereData(LayerSettings);})" value="'+j+'" name="levelRadio" '+h+'><label for="levelRadio'+j+'">'+g+"</label>");f.appendTo("#Levels")}$("#Levels").buttonset();if(!(a===undefined)){a()}});return c}function LoadSphereDataMenu(e,a){var b="php/g_GetGridData.php?dbname="+e.DatabaseStore+"&date="+e.CurrDate+"&level="+e.Level_ID;var c=$.getScript(b);$.when(c).done(function(){if(LayerSettings.LevelName.length>0){$("div#divDate").text(LayerSettings.LevelName+" | "+LayerSettings.CurrDate)}else{$("div#divDate").text(LayerSettings.CurrDate)}RawData.ValueFinal=[];RawData.ValueFinal=ProcessRawDataValue(RawData.Value);LayerSettings.originalMaxValue=RawData.ValueFinal.max();LayerSettings.originalMinValue=RawData.ValueFinal.min();$("#upperBoundLimit").val(LayerSettings.originalMaxValue);$("#lowerBoundLimit").val(LayerSettings.originalMinValue);LayerSettings.maxValue=RawData.ValueFinal.max();LayerSettings.minValue=RawData.ValueFinal.min();if(!(a===undefined)){a()}var f=new URI(window.location.href);f.removeSearch("database");f.addSearch("database",e.Dataset_ID);window.history.replaceState("","",f.search())});return c}function LoadSphereData(c){var b=document.getElementsByTagName("head")[0];try{b.removeChild(d.getElementById("loadDataScript"))}catch(f){}var a=document.createElement("script");a.type="text/javascript";a.id="loadDataScript";a.src="php/g_GetGridData.php?dbname="+c.DatabaseStore+"&date="+c.CurrDate+"&level="+c.Level_ID;a.onload=function(){if(LayerSettings.LevelName.length>0){$("div#divDate").text(LayerSettings.LevelName+" | "+LayerSettings.CurrDate)}else{$("div#divDate").text(LayerSettings.CurrDate)}RawData.ValueFinal=[];RawData.ValueFinal=ProcessRawDataValue(RawData.Value);LayerSettings.originalMaxValue=RawData.ValueFinal.max();LayerSettings.originalMinValue=RawData.ValueFinal.min();$("#upperBoundLimit").val(LayerSettings.originalMaxValue);$("#lowerBoundLimit").val(LayerSettings.originalMinValue);LayerSettings.maxValue=RawData.ValueFinal.max();LayerSettings.minValue=RawData.ValueFinal.min();worldBuffers();if(RawData.Lat.length>0){drawLegend()}var e=new URI(window.location.href);e.removeSearch("database");e.addSearch("database",c.Dataset_ID);window.history.replaceState("","",e.search())};b.appendChild(a)}function LoadJscData(c,g){var b=document.getElementsByTagName("head")[0];try{b.removeChild(d.getElementById("loader"))}catch(f){}var a=document.createElement("script");a.type="text/javascript";a.id="Loader";a.src=c;a.onload=function(){g()};b.appendChild(a)}function LoadTimeseriesData(c){var b=document.getElementsByTagName("head")[0];try{b.removeChild(d.getElementById("LoadTimeseriesData"))}catch(f){}var a=document.createElement("script");a.type="text/javascript";a.id="LoadTimeseriesData";a.src="php/g_GetTimeseriesData.php?dbname="+c.DatabaseStore+"&gridboxId="+c.CurrGridBoxId+"&level="+c.Level_ID;a.onload=function(){document.getElementById("timeSeries").style.display="block";$("#TimeSeriesLevels").empty();for(i=0;i<Levels.Name.length;i++){var h="";if(c.Level_ID==Levels.Level_ID[i]){h='checked="checked"'}var j=Levels.Level_ID[i];var e=Levels.Name[i];var g=$('<label for="timeseries_'+j+'">'+e+'</label><input type="checkbox" onclick="ChangeTimeSeries(this);" '+h+' name="timeseries_'+j+'" id="timeseries_'+j+'">');g.appendTo("#TimeSeriesLevels");$(function(){$("input").button()})}GenerateFirstTimeSeriesChart(c.Level_ID)};b.appendChild(a)}function AddTimeseriesData(c,g){if(!FinalTimeSeriesData.has(g)){var b=document.getElementsByTagName("head")[0];try{b.removeChild(d.getElementById("LoadTimeseriesData"))}catch(f){}var a=document.createElement("script");a.type="text/javascript";a.id="LoadTimeseriesData";a.src="php/g_GetTimeseriesData.php?dbname="+c.DatabaseStore+"&gridboxId="+c.CurrGridBoxId+"&level="+g;a.onload=function(){document.getElementById("timeSeries").style.display="block";AddLevelsToTimeSeries(g)};b.appendChild(a)}else{AddLevelsToTimeSeries(g)}};