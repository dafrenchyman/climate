var WorldVertex={PositionBuffer:[],ColorBuffer:[],IndexBuffer:[],TextureCoordBuffer:[],NormalBuffer:[],TangentBuffer:[],BiTangentBuffer:[]};var GridBoxData=[];var SphereTriangles=[];function createSphereTriangles(a,b,d,c){SphereTriangles.push(d.point);SphereTriangles.push(a.point);SphereTriangles.push(c.point);SphereTriangles.push(c.point);SphereTriangles.push(a.point);SphereTriangles.push(b.point)}function worldBuffers(){WorldVertex.PositionBuffer=[];WorldVertex.ColorBuffer=[];WorldVertex.IndexBuffer=[];SphereTriangles=[];if(displaySettings.pacificCenter){for(E=0;E<RawData.Lon.length;E++){if(RawData.Lon[E]<0){RawData.Lon[E]=RawData.Lon[E]+360}}}else{for(E=0;E<RawData.Lon.length;E++){if(RawData.Lon[E]>180){RawData.Lon[E]=RawData.Lon[E]-360}}}var x=RawData.Lat.unique().sort(function(H,i){return H-i});var l=RawData.Lon.unique().sort(function(H,i){return H-i});var n=RawData.Lon.max();var a=RawData.Lon.min();if(LayerSettings.DataUnits==""||LayerSettings.DataUnits==""){}var F={};GridBoxData=[];for(var w=0;w<x.length;w++){F[[w]]={}}for(var w=0;w<RawData.Lat.length;w++){var B=RawData.Lat[w];var v=RawData.Lon[w];var y=RawData.ValueFinal[w];var e=RawData.GridBox_ID[w];var m=x.indexOf(B);var z=l.indexOf(v);var t;var u=GetColorMap(displaySettings.currColormapName);if(y==null||y==undefined){t=[0,0,0,0]}else{switch(displaySettings.functionForColorMap){case"customColorMapWithMidpoint":t=customColorMapWithMidpoint(u,parseFloat(LayerSettings.minValue),0,parseFloat(LayerSettings.maxValue),y);break;case"customColorMap":t=customColorMap(u,parseFloat(LayerSettings.minValue),parseFloat(LayerSettings.maxValue),y);break;default:t=customColorMap(colorMaps.rainbowColormap,parseInt(LayerSettings.minValue),parseInt(LayerSettings.maxValue),y);break}}var o={coordinates:{x:v,y:B,z:0},normals:{x:0,y:0,z:1},tangents:{x:1,y:0,z:0},biTangents:{x:0,y:1,z:0}};if(displaySettings.globeView=="3d"||displaySettings.globeView=="ortho"){o=cartesianToSphere(v*(Math.PI/180),B*(Math.PI/180),EarthRadius)}var d=vec3.create();d[0]=o.coordinates.x;d[1]=o.coordinates.y;d[2]=o.coordinates.z;var G=vec3.create();G[0]=o.normals.x;G[1]=o.normals.y;G[2]=o.normals.z;var k=vec3.create();k[0]=o.tangents.x;k[1]=o.tangents.y;k[2]=o.tangents.z;var c=vec3.create();c[0]=o.biTangents.x;c[1]=o.biTangents.y;c[2]=o.biTangents.z;var b={gridBox:e,lat:B,lon:v,anomaly:y,color:t,index:null,x:o.coordinates.x,y:o.coordinates.y,z:o.coordinates.z,u:(v+180)/360,v:(B+90)/180,point:d,normal:G,tangent:k,biTangent:c};GridBoxData.push(b);F[m][z]=b}var h=[];if(displaySettings.smoothGridBoxValues){for(var E=0;E<l.length-1;E++){for(var f=0;f<x.length-1;f++){var s=F[f][E];var j=F[f][E+1];var r=F[f+1][E];var q=F[f+1][E+1];var p=[r,s,q];var g=[q,s,j];h.push(p);h.push(g);createSphereTriangles(s,j,r,q)}}var E=l.length-1;for(var f=0;f<x.length-1;f++){var s=$.extend(true,{},F[f][E]);var j=$.extend(true,{},F[f][0]);var r=$.extend(true,{},F[f+1][E]);var q=$.extend(true,{},F[f+1][0]);j.u+=1;q.u+=1;var p=[r,s,q];var g=[q,s,j];h.push(p);h.push(g);createSphereTriangles(s,j,r,q)}if(displaySettings.globeView=="2d"){var C=l.indexOf(n);var A=l.indexOf(a);for(var f=0;f<x.length-1;f++){var s=$.extend(true,{},F[f][C]);var j=$.extend(true,{},F[f][A]);var r=$.extend(true,{},F[f+1][C]);var q=$.extend(true,{},F[f+1][A]);s.lon=s.x=s.point[0]=displaySettings.pacificCenter?0:-180;r.lon=r.x=r.point[0]=displaySettings.pacificCenter?0:-180;s.u=displaySettings.pacificCenter?0.5:0;r.u=displaySettings.pacificCenter?0.5:0;var p=[r,s,q];var g=[q,s,j];h.push(p);h.push(g);createSphereTriangles(s,j,r,q)}for(var f=0;f<x.length-1;f++){var s=$.extend(true,{},F[f][C]);var j=$.extend(true,{},F[f][A]);var r=$.extend(true,{},F[f+1][C]);var q=$.extend(true,{},F[f+1][A]);j.lon=j.x=j.point[0]=displaySettings.pacificCenter?360:180;q.lon=q.x=q.point[0]=displaySettings.pacificCenter?360:180;j.u=displaySettings.pacificCenter?1.5:1;q.u=displaySettings.pacificCenter?1.5:1;var p=[r,s,q];var g=[q,s,j];h.push(p);h.push(g);createSphereTriangles(s,j,r,q)}}}else{for(var E=0;E<l.length-1;E++){for(var f=0;f<x.length-1;f++){var s=jQuery.extend(true,{},F[f][E]);var j=jQuery.extend(true,{},F[f][E+1]);var r=jQuery.extend(true,{},F[f+1][E]);var q=jQuery.extend(true,{},F[f+1][E+1]);s.color[0]=r.color[0];s.color[1]=r.color[1];s.color[2]=r.color[2];j.color[0]=r.color[0];j.color[1]=r.color[1];j.color[2]=r.color[2];q.color[0]=r.color[0];q.color[1]=r.color[1];q.color[2]=r.color[2];var p=[r,s,q];var g=[q,s,j];h.push(p);h.push(g);createSphereTriangles(s,j,r,q)}}var E=l.length-1;for(var f=0;f<x.length-1;f++){var s=jQuery.extend(true,{},F[f][E]);var j=jQuery.extend(true,{},F[f][0]);var r=jQuery.extend(true,{},F[f+1][E]);var q=jQuery.extend(true,{},F[f+1][0]);j.u+=1;q.u+=1;s.color[0]=r.color[0];s.color[1]=r.color[1];s.color[2]=r.color[2];j.color[0]=r.color[0];j.color[1]=r.color[1];j.color[2]=r.color[2];q.color[0]=r.color[0];q.color[1]=r.color[1];q.color[2]=r.color[2];var p=[r,s,q];var g=[q,s,j];h.push(p);h.push(g);createSphereTriangles(s,j,r,q)}if(displaySettings.globeView=="2d"){var C=l.indexOf(n);var A=l.indexOf(a);for(var f=0;f<x.length-1;f++){var s=$.extend(true,{},F[f][C]);var j=$.extend(true,{},F[f][A]);var r=$.extend(true,{},F[f+1][C]);var q=$.extend(true,{},F[f+1][A]);s.lon=s.x=s.point[0]=displaySettings.pacificCenter?0:-180;r.lon=r.x=r.point[0]=displaySettings.pacificCenter?0:-180;s.u=displaySettings.pacificCenter?0.5:0;r.u=displaySettings.pacificCenter?0.5:0;s.color[0]=r.color[0];s.color[1]=r.color[1];s.color[2]=r.color[2];j.color[0]=r.color[0];j.color[1]=r.color[1];j.color[2]=r.color[2];q.color[0]=r.color[0];q.color[1]=r.color[1];q.color[2]=r.color[2];var p=[r,s,q];var g=[q,s,j];h.push(p);h.push(g);createSphereTriangles(s,j,r,q)}for(var f=0;f<x.length-1;f++){var s=$.extend(true,{},F[f][C]);var j=$.extend(true,{},F[f][A]);var r=$.extend(true,{},F[f+1][C]);var q=$.extend(true,{},F[f+1][A]);j.lon=j.x=j.point[0]=displaySettings.pacificCenter?360:180;q.lon=q.x=q.point[0]=displaySettings.pacificCenter?360:180;j.u=displaySettings.pacificCenter?1.5:1;q.u=displaySettings.pacificCenter?1.5:1;s.color[0]=r.color[0];s.color[1]=r.color[1];s.color[2]=r.color[2];j.color[0]=r.color[0];j.color[1]=r.color[1];j.color[2]=r.color[2];q.color[0]=r.color[0];q.color[1]=r.color[1];q.color[2]=r.color[2];var p=[r,s,q];var g=[q,s,j];h.push(p);h.push(g);createSphereTriangles(s,j,r,q)}}}var D=submitDataForTriangles(h);WorldVertex.PositionBuffer=D.position;WorldVertex.ColorBuffer=D.color;WorldVertex.IndexBuffer=D.index;WorldVertex.TextureCoordBuffer=D.textureCoord;WorldVertex.NormalBuffer=D.normal;WorldVertex.TangentBuffer=D.tangent;WorldVertex.BiTangentBuffer=D.biTangent}function submitDataForTriangles(h){var i=0;var w=[];var s=[];var c=[];var u=[];var n=[];var l=[];var b=[];var v=[];var m=[];var a=[];var y=[];var x=[];var e=[];var g=[];for(var k=0;k<h.length;k++){var q=h[k];v.push(q[0].x);v.push(q[0].y);v.push(q[0].z);v.push(q[1].x);v.push(q[1].y);v.push(q[1].z);v.push(q[2].x);v.push(q[2].y);v.push(q[2].z);a.push(q[0].normal[0]);a.push(q[0].normal[1]);a.push(q[0].normal[2]);a.push(q[1].normal[0]);a.push(q[1].normal[1]);a.push(q[1].normal[2]);a.push(q[2].normal[0]);a.push(q[2].normal[1]);a.push(q[2].normal[2]);y.push(q[0].tangent[0]);y.push(q[0].tangent[1]);y.push(q[0].tangent[2]);y.push(q[1].tangent[0]);y.push(q[1].tangent[1]);y.push(q[1].tangent[2]);y.push(q[2].tangent[0]);y.push(q[2].tangent[1]);y.push(q[2].tangent[2]);x.push(q[0].biTangent[0]);x.push(q[0].biTangent[1]);x.push(q[0].biTangent[2]);x.push(q[1].biTangent[0]);x.push(q[1].biTangent[1]);x.push(q[1].biTangent[2]);x.push(q[2].biTangent[0]);x.push(q[2].biTangent[1]);x.push(q[2].biTangent[2]);g.push(q[0].u);g.push(q[0].v);g.push(q[1].u);g.push(q[1].v);g.push(q[2].u);g.push(q[2].v);m.push(q[0].color[0]);m.push(q[0].color[1]);m.push(q[0].color[2]);m.push(1);m.push(q[1].color[0]);m.push(q[1].color[1]);m.push(q[1].color[2]);m.push(1);m.push(q[2].color[0]);m.push(q[2].color[1]);m.push(q[2].color[2]);m.push(1);e.push(i++);e.push(i++);e.push(i++);if((i*2)/(Math.pow(2,16)-1)>1||k==h.length-1){var r=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,r);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(v),gl.STATIC_DRAW);r.itemSize=3;r.numItems=v.length/3;w.push(r);var j=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,j);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(g),gl.STATIC_DRAW);j.itemSize=2;j.numItems=g.length/2;b.push(j);var t=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,t);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(m),gl.STATIC_DRAW);t.itemSize=4;t.numItems=m.length/4;s.push(t);var p=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,p);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(a),gl.STATIC_DRAW);p.itemSize=3;p.numItems=a.length/3;u.push(p);var f=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,f);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(y),gl.STATIC_DRAW);f.itemSize=3;f.numItems=y.length/3;n.push(f);var d=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,d);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(x),gl.STATIC_DRAW);d.itemSize=3;d.numItems=x.length/3;l.push(d);var o=gl.createBuffer();gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,o);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),gl.STATIC_DRAW);o.itemSize=1;o.numItems=e.length;c.push(o);v=[];m=[];e=[];g=[];a=[];y=[];x=[];i=0}}return{position:w,index:c,color:s,textureCoord:b,normal:u,tangent:n,biTangent:l}}function CreateLatLonGridLines(k,l){var d={Lat:[],Lon:[]};var f=1;var i=-90;var j=90;var h=-180;var b=180;d.Lat.push(null);d.Lon.push(null);for(var e=0;e<=(b-h)/k;e++){var g=h+e*k;for(var a=0;a<=(j-i)/f;a++){var c=i+a*f;d.Lat.push(c);d.Lon.push(g)}d.Lat.push(null);d.Lon.push(null)}for(var a=0;a<=(j-i)/l;a++){var c=i+a*l;for(var e=0;e<=(b-h)/f;e++){var g=h+e*f;d.Lat.push(c);d.Lon.push(g)}d.Lat.push(null);d.Lon.push(null)}return d}var LineVertex={PositionBuffer:[],ColorBuffer:[],NormalBuffer:[],IndexBuffer:[],TangentBuffer:[],BiTangentBuffer:[],TextureCoordBuffer:[]};function lineBuffers(){LineVertex={PositionBuffer:[],ColorBuffer:[],NormalBuffer:[],IndexBuffer:[],TangentBuffer:[],BiTangentBuffer:[],TextureCoordBuffer:[]};if(displaySettings.coasts&&Coasts.Lat.length>0){generateLineVertex(Coasts,[0.35,0.35,0.35,1])}if(displaySettings.minorIslands&&Coasts_MinorIslands.Lat.length>0){generateLineVertex(Coasts_MinorIslands,[0.35,0.35,0.35,1])}if(displaySettings.lakes&&Lakes.Lat.length>0){generateLineVertex(Lakes,[0.45,0.45,0.45,1])}if(displaySettings.rivers&&Rivers.Lat.length>0){generateLineVertex(Rivers,[0.45,0.45,0.45,1])}if(displaySettings.latLons){var a=CreateLatLonGridLines(10,10);generateLineVertex(a,[0.4,0.4,0.4,1])}if(displaySettings.geoLines){generateLineVertex(GeoLines,[0.45,0.45,0.45,1])}if(displaySettings.timeZones){generateLineVertex(TimeZones,[0.45,0.45,0.45,1])}}function generateLineVertex(c,b){var a=submitDataForLines(c,b);LineVertex.PositionBuffer=LineVertex.PositionBuffer.concat(a.position);LineVertex.ColorBuffer=LineVertex.ColorBuffer.concat(a.color);LineVertex.IndexBuffer=LineVertex.IndexBuffer.concat(a.index);LineVertex.NormalBuffer=LineVertex.NormalBuffer.concat(a.normal);LineVertex.TangentBuffer=LineVertex.TangentBuffer.concat(a.tangent);LineVertex.BiTangentBuffer=LineVertex.BiTangentBuffer.concat(a.biTangent);LineVertex.TextureCoordBuffer=LineVertex.TextureCoordBuffer.concat(a.texture)}function submitDataForLines(x,w){dataLon=x.Lon;dataLat=x.Lat;var k=[];var m=[];var c=[];var b=[];var f=[];var s=[];var D=[];var H=[];var q=[];var d=[];var a=[];var A=[];var v=[];var n=[];var h;var G=[];var p=0;for(var C=0;C<dataLat.length;C++){if(dataLat[C]==null){if(C!=0){for(var z=1;z<G.length;z++){n.push(G[z-1]);n.push(G[z])}}G=[];C++}if((C!=0&&p/(Math.pow(2,16)-2000)>1)||C==dataLat.length-2){p=0;for(var z=1;z<G.length;z++){n.push(G[z-1]);n.push(G[z])}var I=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,I);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(H),gl.STATIC_DRAW);I.itemSize=3;I.numItems=H.length/3;k.push(I);var o=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,o);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(q),gl.STATIC_DRAW);o.itemSize=4;o.numItems=q.length/4;m.push(o);var u=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,u);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(d),gl.STATIC_DRAW);u.itemSize=3;u.numItems=d.length/3;c.push(u);var J=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,J);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(a),gl.STATIC_DRAW);J.itemSize=3;J.numItems=a.length/3;b.push(J);var l=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,l);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(A),gl.STATIC_DRAW);l.itemSize=3;l.numItems=A.length/3;f.push(l);var r=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,r);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(v),gl.STATIC_DRAW);r.itemSize=2;r.numItems=v.length/2;s.push(r);var E=gl.createBuffer();gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,E);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),gl.STATIC_DRAW);E.itemSize=1;E.numItems=n.length;D.push(E);G=[];H=[];q=[];d=[];a=[];A=[];v=[];n=[]}var y=dataLon[C];var F=dataLat[C];if(displaySettings.globeView=="2d"){var g=displaySettings.pacificCenter?360:180;var e=displaySettings.pacificCenter?0:-180;if(displaySettings.pacificCenter){if(y<0){y=y+360}}var t={coordinates:{x:y,y:F,z:0.25},normals:{x:0,y:0,z:1},u:(y+180)/360,v:(F+90)/180,tangents:{x:1,y:0,z:0},biTangents:{x:0,y:1,z:0}};var B=false;if(C==0){h=y}if(Math.abs(y-h)>300&&G.length>0){if(h<y){t.coordinates.x=e}else{if(h>y){t.coordinates.x=g}}B=true}if(B){H.push(t.coordinates.x);H.push(t.coordinates.y);H.push(t.coordinates.z);d.push(t.normals.x);d.push(t.normals.y);d.push(t.normals.z);a.push(t.tangents.x);a.push(t.tangents.y);a.push(t.tangents.z);A.push(t.biTangents.x);A.push(t.biTangents.y);A.push(t.biTangents.z);v.push(t.u);v.push(t.v);q.push(w[0]);q.push(w[1]);q.push(w[2]);q.push(w[3]);G.push(p);for(var z=1;z<G.length;z++){n.push(G[z-1]);n.push(G[z])}G=[];h=y;p++}}var t={coordinates:{x:y,y:F,z:0.25},normals:{x:0,y:0,z:1},u:(y+180)/360,v:(F+90)/180,tangents:{x:1,y:0,z:0},biTangents:{x:0,y:1,z:0}};if(displaySettings.globeView=="3d"||displaySettings.globeView=="ortho"){t=cartesianToSphere(y*(Math.PI/180),F*(Math.PI/180),EarthRadius+0.01)}H.push(t.coordinates.x);H.push(t.coordinates.y);H.push(t.coordinates.z);d.push(t.normals.x);d.push(t.normals.y);d.push(t.normals.z);a.push(t.tangents.x);a.push(t.tangents.y);a.push(t.tangents.z);A.push(t.biTangents.x);A.push(t.biTangents.y);A.push(t.biTangents.z);v.push(t.u);v.push(t.v);q.push(w[0]);q.push(w[1]);q.push(w[2]);q.push(w[3]);G.push(p);h=y;p++}return{position:k,index:D,color:m,normal:c,tangent:b,biTangent:f,texture:s}}var latLinesVertexPositionBuffer=[];var latLinesVertexColorBuffer=[];var lonLinesVertexPositionBuffer=[];var lonLinesVertexColorBuffer=[];var currDegreeStep=10;function latLonBuffers(){latLinesVertexPositionBuffer=[];latLinesVertexColorBuffer=[];lonLinesVertexPositionBuffer=[];lonLinesVertexColorBuffer=[];var l=currDegreeStep;var j=2.5;for(var b=0;b<180/l;b++){curLat=b*l-90;var m=[];var a=[];for(f=0;f<=360/j;f++){curLon=(f*j)-(displaySettings.pacificCenter==true?0:180);var e={x:curLon,y:curLat,z:2};if(displaySettings.globeView=="3d"||displaySettings.globeView=="ortho"){var e=cartesianToSphere(curLon*(Math.PI/180),curLat*(Math.PI/180),EarthRadius+0.05)}m.push(e.x);m.push(e.y);m.push(e.z);a.push(0.4);a.push(0.4);a.push(0.4);a.push(1)}var h=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,h);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(m),gl.STATIC_DRAW);h.itemSize=3;h.numItems=m.length/3;latLinesVertexPositionBuffer.push(h);var g=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,g);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(a),gl.STATIC_DRAW);g.itemSize=4;g.numItems=a.length/4;latLinesVertexColorBuffer.push(g)}for(var f=0;f<360/l;f++){curLon=f*l;var i=[];var c=[];for(b=0;b<=360/j;b++){curLat=b*j;var e={x:curLon-180,y:curLat-90,z:2};if(displaySettings.globeView=="3d"||displaySettings.globeView=="ortho"){var e=cartesianToSphere(curLon*(Math.PI/180),curLat*(Math.PI/180),EarthRadius+0.05)}i.push(e.x);i.push(e.y);i.push(e.z);c.push(0.4);c.push(0.4);c.push(0.4);c.push(1)}var d=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,d);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(i),gl.STATIC_DRAW);d.itemSize=3;d.numItems=i.length/3;lonLinesVertexPositionBuffer.push(d);var k=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,k);gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(c),gl.STATIC_DRAW);k.itemSize=4;k.numItems=c.length/4;lonLinesVertexColorBuffer.push(k)}}function SetAllGlBuffers(b,c,d){gl.useProgram(b);setMatrixLightingUniforms(b);for(var a=0;a<c.PositionBuffer.length;a++){gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,globeBumpMap);gl.uniform1i(b.samplerUniform,0);gl.bindBuffer(gl.ARRAY_BUFFER,c.PositionBuffer[a]);gl.vertexAttribPointer(b.vertexPositionAttribute,c.PositionBuffer[a].itemSize,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ARRAY_BUFFER,c.ColorBuffer[a]);gl.vertexAttribPointer(b.vertexColorAttribute,c.ColorBuffer[a].itemSize,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ARRAY_BUFFER,c.NormalBuffer[a]);gl.vertexAttribPointer(b.vertexNormalAttribute,c.NormalBuffer[a].itemSize,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ARRAY_BUFFER,c.TangentBuffer[a]);gl.vertexAttribPointer(b.vertexTangentAttribute,c.TangentBuffer[a].itemSize,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ARRAY_BUFFER,c.BiTangentBuffer[a]);gl.vertexAttribPointer(b.vertexBiTangentAttribute,c.BiTangentBuffer[a].itemSize,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ARRAY_BUFFER,c.TextureCoordBuffer[a]);gl.vertexAttribPointer(b.textureCoordAttribute,c.TextureCoordBuffer[a].itemSize,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,c.IndexBuffer[a]);setMatrixUniforms(b);gl.drawElements(d,c.IndexBuffer[a].numItems,gl.UNSIGNED_SHORT,0)}};