function drawLegend(){var j=140,d=400;d3.select("#legend").selectAll("svg").remove();var k=d3.select("#legend").append("svg").attr("width",j).attr("height",d);var i=k.append("defs").append("svg:linearGradient").attr("id","gradient").attr("x1","100%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad");var c=GetColorMap(displaySettings.currColormapName);for(var a=0;a<=1;a+=0.05){var f=(a*100).toString()+"%";var l;if(displaySettings.functionForColorMap=="customColorMap"){l=customColorMapByPercentage(c,0,1,1-a)}else{if(displaySettings.functionForColorMap=="customColorMapWithMidpoint"){l=customColorMapWithMidpointByPercentage(c,parseFloat(LayerSettings.minValue),0,parseFloat(LayerSettings.maxValue),1-a)}}var g=rgbToHex(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255));i.append("stop").attr("offset",f).attr("stop-color",g).attr("stop-opacity",1)}k.append("rect").attr("width",j-100).attr("height",d-100).style("fill","url(#gradient)").attr("transform","translate(0,10)");var e=d3.scale.linear().range([300,0]).domain([LayerSettings.minValue,LayerSettings.maxValue]);var b=d3.svg.axis().scale(e).orient("right");k.append("g").attr("class","y axis").attr("transform","translate(41,10)").call(b).append("text").attr("transform","rotate(-90)").attr("y",50).attr("dy",".71em").style("text-anchor","end").text("Temperature ("+LayerSettings.TemperatureSymbol+")")};